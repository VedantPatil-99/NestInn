<% layout("/layouts/boilerplate") %>

<div class="my-4 container-fluid confirm-pg ">
	<h2 class="pt-4 pb-2">Confirm Your Reservation</h2>

	<div class="card shadow-sm confirm-card z-6 rounded-4 border border-primary-subtle" >
		<div class="card-body p-4 h-auto ">
			<h3 class="text-dark fw-semibold mb-3">
				<%= hostel.title %> — ₹<%= hostel.price.toLocaleString("en-IN") %> per
				month
			</h3>
			<p class="text-dark fw-semibold ">
				Stay: <%= allDetails.durationMonths %> months | Students: <%=
				allDetails.studentCount %>
				<!-- Plan: <%# mealPlan ? "Yes" : "No" %> -->
			</p>

			<hr />
			<h5 class="mb-3">Price Breakdown</h5>
			<ul class="list-group list-group-flush rounded-4 mb-3">
				<li class="list-group-item d-flex justify-content-between bg-secondary-subtle">
					Base Price × Months:
					<span class="fw-bold">₹<%= allDetails.basePrice.toLocaleString("en-IN") %></span>
				</li>
				<li class="list-group-item d-flex justify-content-between">
					Discounted Price per Student:
					<span class="fw-bold"
						>₹<%= allDetails.pricePerStudent.toLocaleString("en-IN") %></span
					>
				</li>
				<li class="list-group-item d-flex justify-content-between bg-secondary-subtle">
					Subtotal (All Students):
					<span class="fw-bold">₹<%= allDetails.subtotal.toLocaleString("en-IN") %></span>
				</li>
				<%#if (mealPlan) { %>
				<!-- <li class="list-group-item d-flex justify-content-between">
					Meal Plan Cost:
					<span
						>₹<%# priceBreakdown.mealPlanCost.toLocaleString("en-IN") %></span
					>
				</li> -->
				<%# } %>
				<li class="list-group-item d-flex justify-content-between">
					Security Deposit:
					<span class="fw-bold">₹2,000<%# 2000.toLocaleString("en-IN") %></span>
				</li>
			</ul>

			<div class="d-flex justify-content-between align-items-center bg-light-subtle p-3 rounded-4">
				<h5 class="m-0">Total Amount:</h5>
				<h4 class="text-success fw-bold m-0">
					₹<%= (allDetails.totalAmount + 2000).toLocaleString("en-IN") %>
				</h4>
			</div>

			<form
				action="/reservations/<%= hostel._id %>/confirm-success"
				method="POST"
			>
				<!--  -->
				<input type="hidden" name="user" value="<%= allDetails.user %>" /><input
					type="hidden"
					name="hostel"
					value="<%= hostel._id %>"
				/>
				<input
					type="hidden"
					name="durationMonths"
					value="<%= allDetails.durationMonths %>"
				/>
				<input
					type="hidden"
					name="totalPrice"
					value="<%= allDetails.totalAmount %>"
				/>
				<input type="hidden" name="status" value="<%= allDetails.status %>" />
				<input
					type="hidden"
					name="paymentStatus"
					value="<%= allDetails.paymentStatus %>"
				/>
				<input
					type="hidden"
					name="startDate"
					value="<%= allDetails.startDate %>"
				/>
				<input type="hidden" name="endDate" value="<%= allDetails.endDate %>" />
				<input
					type="hidden"
					name="students"
					value="<%= allDetails.studentCount %>"
				/>
				<!-- <input type="hidden" name="mealPlan" value="<%# mealPlan %>" /> -->
				<button class="btn btn-dark btn-block mt-3">Confirm & Reserve</button>
			</form>
		</div>
	</div>
	<div class="invisible" style="height: 8vh;"></div>
</div>
